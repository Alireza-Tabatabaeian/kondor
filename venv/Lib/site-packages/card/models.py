from django.contrib.auth.models import User
from django.db import models
from question.models import Course, Question

# Create your models here.
Box_Default_Chances = (45, 27, 17, 7, 4, -9999)


class Cart(models.Model):
    view_chance = models.IntegerField(verbose_name="View Chance", default=45)
    box = models.IntegerField(verbose_name="Box", default=1)
    user = models.ForeignKey(User, verbose_name="User", on_delete=models.CASCADE)
    question = models.ForeignKey('question.Question', verbose_name="Question", on_delete=models.CASCADE)
    course = models.ForeignKey('question.Course', verbose_name="Course", on_delete=models.PROTECT)

    def __str__(self):
        return 'Question: {}, User: {}, level: {}'.format(self.question, self.user, self.box)

    def reset(self):
        self.box = 1
        self.view_chance = 45

    def levelUp(self):
        if self.box < 6:
            self.view_chance = Box_Default_Chances[self.box]
            self.box = self.box + 1
        else:
            self.view_chance = -9999